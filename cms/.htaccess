Options All -Indexes
Options -MultiViews

RewriteEngine On

# Protect sensitive files
<FilesMatch "^(config\.php|config\.example\.php|\.env|\.env\.local)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Protect sensitive directories
RewriteRule ^(config|vendor|backups|migrations|\.cursor|\.git|extensions/vendor) - [F,L]

# Protect PHP files in sensitive locations
RewriteRule ^(config|vendor|extensions/vendor)/.*\.php$ - [F,L]

# CMS routing
# Exclude static files from rewrite to serve them with correct MIME type
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} !\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot|map|json|xml|pdf|zip|mp4|webm|ogg|mp3|wav)$ [NC]
RewriteRule ^ index.php [QSA,L]